<!DOCTYPE html>
<html lang="kr">
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <title>Unicorn Ranch</title>

    <link rel="stylesheet" type="text/css" id="bootstrapBasic" href="/extstatic/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" id="bootstrapGrid" href="/extstatic/css/bootstrap-grid.min.css"/>
    <link rel="stylesheet" type="text/css" id="bootstrapUtil" href="/extstatic/css/bootstrap-utilities.min.css"/>

    <link rel="stylesheet" type="text/css" id="layoutStylesheet" href="/extstatic/css/xm-layout.css"/>

    <script src="/extstatic/ext/Highcharts-9.2.2/code/highcharts.js"></script>
    <script src="/extstatic/ext/Highcharts-9.2.2/code/modules/data.js"></script>
    <script src="/extstatic/ext/Highcharts-9.2.2/code/modules/exporting.js"></script>
    <script src="/extstatic/ext/Highcharts-9.2.2/code/modules/export-data.js"></script>
    <script src="/extstatic/ext/Highcharts-9.2.2/code/modules/sonification.js"></script>
    <script src="/extstatic/ext/Highcharts-9.2.2/code/modules/accessibility.js"></script>

    <script src="/extstatic/js/jquery-3.5.1.min.js"></script>
    <script src="/extstatic/js/jquery-ui.min.js"></script>

    <script>

        var sectorId;
        var sectorName;
        var jsonArray;

        var jsonSectorPatent;
        var categoryData_PT = new Array();
        var categoryData_PR = new Array();
        var chartData_PT = new Array(); // 출원건수
        var chartData_PR = new Array(); // 등록건수

        var jsonMainCompany;
        var mainCompanyName = new Array(10); // 주요기업명
        var mainCompanyCount = new Array(10); // 주요기업특허수

        var jsonMainCompanies;
        var mainCompaniesName = new Array(10); // 주요기업명
        var mainCompaniesTrend = new Array(10); // 주요기업연도별출원수

        function getParameter(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        function fillSectorInfo() {

            $("._sector_name").text(jsonArray.sectorName);
            $("._rptDt").text("Weekly Report Date : " + jsonArray.rptDt);
            $("._rptOutline").text(jsonArray.rptOutline);
            $("._rptIssue").text(jsonArray.rptIssue);

            sectorName = jsonArray.sectorName + "섹터";

        }

        function getSectorInfo(stid) {

            jsonArray = null;

            $.ajax({
                url: 'https://c-api.10bagger.co.kr/v1/sector/' + stid,
                type: 'GET',
                dataType: 'json',
                success : function(result) {
                    if( result != null ) {
                        jsonArray = result;
                    }
                },
                complete: function(result) {
                    fillSectorInfo();
                },
                error : function(request, status, error) {
                    jsonArray = "{errorcode:-1,errormsg:" + request.responseText + "}";
                    //alert("섹터번호를 정확하게 입력해 주십시요.");
                }
            });

        }

        function getPatentTrend(stid) {

            jsonSectorPatent = null;

            $.ajax({
                url: 'https://c-api.10bagger.co.kr/v1/report/sector/patent/trend/' + stid,
                type: 'GET',
                dataType: 'json',
                success : function(result) {
                    if( result != null ) {
                        jsonSectorPatent = result;
                    }
                },
                complete: function(result) {
                    setPatentTrend();
                },
                error : function(request, status, error) {
                    jsonSectorPatent = "{errorcode:-1,errormsg:" + request.responseText + "}";
                }
            });

        }

        function setPatentTrend() {
            let now = new Date();
            let endYearApp = now.getFullYear() - 2
            let startYearApp = endYearApp -9
            let endYearReg = now.getFullYear() - 1
            let startYearReg = endYearReg -9
            
            let sectorPatentApp = jsonSectorPatent.filter(el => 
                (el.year >=  startYearApp && el.year <= endYearApp)
            )
            
            let sectorPatentReg = jsonSectorPatent.filter(el => 
                (el.year >=  startYearReg && el.year <= endYearReg)
            )

            for( var i=0; i<sectorPatentApp.length; i++ ) {
                categoryData_PT[i] = sectorPatentApp[i].year;
                chartData_PT[i] = sectorPatentApp[i].appCount;
            }
            
            for( var i=0; i<sectorPatentReg.length; i++ ) {
                categoryData_PR[i] = sectorPatentReg[i].year;
                chartData_PR[i] = sectorPatentReg[i].regCount;
            }
            $("#appYearCount").text("최근 " + sectorPatentApp.length + "년간 특허 출원 동향")
            $("#regYearCount").text("최근 " + sectorPatentReg.length + "년간 특허 등록 동향")
            drawPatentTrendPTChart();
            drawPatentTrendPRChart();

        }

        function drawPatentTrendPTChart() {

            $(document).ready(function(){
                Highcharts.chart('patent-pt', {
                    chart: {
                        backgroundColor:'rgba(255, 255, 255, 0)',
                        plotBorderWidth: 1,
                        events: {
                            load: function() {
                                var chart = this;
                                var bottom = chart.plotHeight+15;

                                $.each(chart.series[0].data,function(i,data){

                                });

                            }
                        }
                    },

                    title: {
                        text: ''
                    },

                    exporting: {
                        enabled: false
                    },
                    credits: {enabled: false},

                    subtitle: {
                        text: ''
                    },

                    yAxis: {
                        title: {
                            text: ''
                        },
                        labels:{
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold'
                            }
                        }
                    },

                    xAxis: {
                        categories: categoryData_PT,
                        labels: {
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold'
                            }
                        }
                    },

                    plotOptions: {
                        series: {
                            states: {
                                inactive: {
                                    opacity: 1
                                },
                                hover:{
                                    enabled:true
                                },
                            },
                            events: {
                                legendItemClick: function() {
                                    return false;
                                }
                            }
                        }
                    },

                    series: [{
                        showInLegend: false,
                        name: sectorName,
                        label: {
                            enabled: false
                        },
                        marker: {
                            enabled: true,
                            symbol: 'circle',
                            radius: 3,
                        },
                        color: '#AE2318',
                        data: chartData_PT,
                        dataLabels: {
                            enabled: true,
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold',
                                textOutline:'0px'
                            }
                        }
                    }],
                });
            });

        }

        function drawPatentTrendPRChart() {

            $(document).ready(function(){
                Highcharts.chart('patent-pr', {
                    chart: {
                        backgroundColor:'rgba(255, 255, 255, 0)',
                        plotBorderWidth: 1,
                        events: {
                            load: function() {
                                var chart = this;
                                var bottom = chart.plotHeight+15;

                                $.each(chart.series[0].data,function(i,data){

                                });

                            }
                        }
                    },

                    title: {
                        text: ''
                    },

                    exporting: {
                        enabled: false
                    },
                    credits: {enabled: false},

                    subtitle: {
                        text: ''
                    },

                    yAxis: {
                        title: {
                            text: ''
                        },
                        labels:{
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold'
                            }
                        }
                    },

                    xAxis: {
                        categories: categoryData_PR,
                        labels: {
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold'
                            }
                        }
                    },

                    plotOptions: {
                        series: {
                            states: {
                                inactive: {
                                    opacity: 1
                                },
                                hover:{
                                    enabled:true
                                },
                            },
                            events: {
                                legendItemClick: function() {
                                    return false;
                                }
                            }
                        }
                    },

                    series: [{
                        showInLegend: false,
                        name: sectorName,
                        label: {
                            enabled: false
                        },
                        marker: {
                            enabled: true,
                            symbol: 'circle',
                            radius: 3,
                        },
                        color: '#AE2318',
                        data: chartData_PR,
                        dataLabels: {
                            enabled: true,
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold',
                                textOutline:'0px'
                            }
                        }
                    }],
                });
            });

        }

        function getMainCompany(stid) {

            jsonMainCompany = null;

            $.ajax({
                url: 'https://c-api.10bagger.co.kr/v1/report/sector/major/company/' + stid,
                type: 'GET',
                dataType: 'json',
                success : function(result) {
                    if( result != null ) {
                        jsonMainCompany = result;
                    }
                },
                complete: function(result) {
                    setMainCompany();
                },
                error : function(request, status, error) {
                    jsonMainCompany = "{errorcode:-1,errormsg:" + request.responseText + "}";
                }
            });

        }

        function setMainCompany() {

            for( var i=0; i<jsonMainCompany.length; i++ ) {
                mainCompanyName[i] = jsonMainCompany[i].isuKorNm;
                mainCompanyCount[i] = jsonMainCompany[i].count;
            }

            drawMainCompanyChart();

        }

        function drawMainCompanyChart() {

            $(document).ready(function(){
                Highcharts.chart('main_cp', {
                    chart: {
                        type: 'bar',
                        backgroundColor:'rgba(255, 255, 255, 0)',
                        plotBorderWidth: 1
                    },
                    title: {
                        text: ''
                    },
                    exporting: {
                        enabled: false
                    },
                    credits: {
                        enabled: false
                    },
                    subtitle: {
                        text: ''
                    },
                    yAxis: {
                        title: {
                            text: ''
                        },
                        labels:{
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold'
                            }
                        }
                    },
                    xAxis: {
                        categories: mainCompanyName,
                        labels: {
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold'
                            }
                        }
                    },
                    plotOptions: {
                        series: {
                            states: {
                                inactive: {
                                    opacity: 1
                                },
                                hover:{
                                    enabled:true
                                },
                            },
                            events: {
                                legendItemClick: function() {
                                    return false;
                                }
                            }
                        }
                    },

                    series: [{
                        showInLegend: false,
                        name: '특허보유건수',
                        label: {
                            enabled: false
                        },
                        marker: {
                            enabled: true,
                            symbol: 'circle',
                            radius: 3,
                        },
                        color: '#0047AB',
                        data: mainCompanyCount,
                        dataLabels: {
                            enabled: true,
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold',
                                textOutline:'0px'
                            }
                        }
                    }],
                });
            });

        }

        function getMainCompanies(stid) {

            jsonMainCompanies = null;

            $.ajax({
                url: 'https://c-api.10bagger.co.kr/v1/report/sector/major/company/year/' + stid,
                type: 'GET',
                dataType: 'json',
                success : function(result) {
                    if( result != null ) {
                        jsonMainCompanies = result;
                    }
                },
                complete: function(result) {
                    setMainCompanies();
                },
                error : function(request, status, error) {
                    jsonMainCompanies = "{errorcode:-1,errormsg:" + request.responseText + "}";
                }
            });

        }

        function setMainCompanies() {

            for( var i=0; i<jsonMainCompanies.length; i++ ) {

                mainCompaniesName[i] = jsonMainCompanies[i].isuKorNm;

                var cpiesObj = jsonMainCompanies[i].patentTrend;
                var cpiesYear = new Array(20);
                var cpiesAppCount = new Array(20);
                var cpiesResult = new Array(2);

                for( var n=0; n<cpiesObj.length; n++ ) {
                    cpiesYear[n] = cpiesObj[n].year;
                    cpiesAppCount[n] = cpiesObj[n].appCount;
                }

                cpiesResult[0] = cpiesYear;
                cpiesResult[1] = cpiesAppCount;
                mainCompaniesTrend[i] = cpiesResult;
            }

            //alert( mainCompaniesTrend[0][1] );

            for( var i=0; i<jsonMainCompanies.length; i++ ) {
                drawMainCompaniesChart(i, mainCompaniesName[i], mainCompaniesTrend[i]);
            }

        }

        function drawMainCompaniesChart(idx, cpName, trendData) {

            var divId = "main_cp" + idx;
            $("#"+divId).css("display","flex");

            $(document).ready(function(){
                Highcharts.chart(divId, {
                    chart: {
                        type: 'column',
                        backgroundColor:'rgba(255, 255, 255, 0)',
                        plotBorderWidth: 1
                    },
                    title: {
                        text: cpName,
                        style: {
                            fontFamily: 'Noto Sans KR',
                            fontSize: '12px',
                            color: '#191919',
                            fontWeight:'normal'
                        }
                    },
                    exporting: {
                        enabled: false
                    },
                    credits: {
                        enabled: false
                    },
                    subtitle: {
                        text: ''
                    },
                    yAxis: {
                        title: {
                            text: ''
                        },
                        labels:{
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold'
                            }
                        }
                    },
                    xAxis: {
                        categories: trendData[0],
                        labels: {
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold'
                            }
                        }
                    },
                    plotOptions: {
                        series: {
                            states: {
                                inactive: {
                                    opacity: 1
                                },
                                hover:{
                                    enabled:true
                                },
                            },
                            events: {
                                legendItemClick: function() {
                                    return false;
                                }
                            }
                        }
                    },

                    series: [{
                        showInLegend: false,
                        name: '특허보유건수',
                        label: {
                            enabled: false
                        },
                        marker: {
                            enabled: true,
                            symbol: 'circle',
                            radius: 3,
                        },
                        color: '#0047AB',
                        data: trendData[1],
                        dataLabels: {
                            enabled: false,
                            style: {
                                fontFamily: 'Noto Sans KR',
                                fontSize: '8px',
                                color: '#191919',
                                fontWeight:'bold',
                                textOutline:'0px'
                            }
                        }
                    }],
                });
            });

        }

        function drawInvestmentChart(sectorId, securityType) {
            $(document).ready(function(){
                if(!securityType){
                    return;
                }
                $.ajax({
                    type: 'GET',
                    url: 'https://c-api.10bagger.co.kr/v1/mts/stk',
                    data: {pageNo: 1, pageSize: 5, searchSectorNo: sectorId, sectorStkSetYn: 'Y', securityType: securityType,  sortColumn: 'TII', sortOrdr: 'ASC'},
                    dataType: 'json',
                    success: function(response) {
                        var data = response;
                        for( var i=0; i<5; i++ ) {
                            if(data.stks[i]){
                              if( (i%2) == 0 ) {
                                  if( (i+1) == 5 ) {
                                      var htmlStr = "<div class='xl-st-row'>"
                                          + " <div class='xl-str-1 xl-flex-col xl-center' style='border-right:none'>" + data.stks[i].isuKorNm + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='border-bottom:red solid 1px;border-left:red solid 1px;border-right:red solid 1px'>" + ((data.stks[i].tii).toFixed(2)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + ((data.stks[i].tss).toFixed(1)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].assdValue + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].tcg + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + (data.stks[i].apes.toFixed(1)) + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].patentCount + "</div>"
                                          + " <div class='xl-str-3 xl-flex-col xl-center' style='text-align:center'>" + (data.stks[i].mktCap).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + "</div>";
                                      $("#_investment_top5").append(htmlStr);
                                  } else {
                                      var htmlStr = "<div class='xl-st-row'>"
                                          + " <div class='xl-str-1 xl-flex-col xl-center' style='border-right:none'>" + data.stks[i].isuKorNm + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='border-left:red solid 1px;border-right:red solid 1px'>" + ((data.stks[i].tii).toFixed(2)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + ((data.stks[i].tss).toFixed(1)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].assdValue + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].tcg + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + (data.stks[i].apes.toFixed(1)) + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].patentCount + "</div>"
                                          + " <div class='xl-str-3 xl-flex-col xl-center' style='text-align:center'>" + (data.stks[i].mktCap).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + "</div>";
                                      $("#_investment_top5").append(htmlStr);
                                  }
                              } else {
                                  if( (i+1) == 5 ) {
                                      var htmlStr = "<div class='xl-st-row'>"
                                          + " <div class='xl-str-1 xl-flex-col xl-center xl-str-g' style='border-right:none'>" + data.stks[i].isuKorNm + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='border-bottom:red solid 1px;border-left:red solid 1px;border-right:red solid 1px'>" + ((data.stks[i].tii).toFixed(2)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + ((data.stks[i].tss).toFixed(1)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].assdValue + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].tcg + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + (data.stks[i].apes.toFixed(1)) + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].patentCount + "</div>"
                                          + " <div class='xl-str-3 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + (data.stks[i].mktCap).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
  
                                          + "</div>";
                                      $("#_investment_top5").append(htmlStr);
                                  } else {
                                      var htmlStr = "<div class='xl-st-row'>"
                                          + " <div class='xl-str-1 xl-flex-col xl-center xl-str-g' style='border-right:none'>" + data.stks[i].isuKorNm + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='border-left:red solid 1px;border-right:red solid 1px'>" + ((data.stks[i].tii).toFixed(2)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + ((data.stks[i].tss).toFixed(1)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].assdValue + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].tcg + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + (data.stks[i].apes.toFixed(1)) + "</div>"
                                          + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].patentCount + "</div>"
                                          + " <div class='xl-str-3 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + (data.stks[i].mktCap).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
  
                                          + "</div>";
                                      $("#_investment_top5").append(htmlStr);
                                  }
                              }
                            }
                        }
                        
                    }
                });
            });

        }

        function drawTSSRankingChart() {

            $(document).ready(function(){
                $.ajax({
                    type: 'GET',
                    url: 'https://c-api.10bagger.co.kr/v1/stk',
                    data: {pageNo: 1, pageSize: 1000, searchSectorNo: 4, sortColumn: 'TSS', sortOrdr: 'DESC'},
                    dataType: 'json',
                    success: function(response) {
                        var data = response;

                        for( var i=0; i<data.totalCnt; i++ ) {
                            if( (i%2) == 0 ) {
                                if( (i+1) == data.totalCnt ) {
                                    var htmlStr = "<div class='xl-st-row'>"
                                        + " <div class='xl-str-1 xl-flex-col xl-center'>" + data.stks[i].isuKorNm + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='border-right:none'>" + ((data.stks[i].corp.tii).toFixed(2)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='border-bottom:red solid 1px;border-left:red solid 1px;border-right:red solid 1px;text-align:center'>" + ((data.stks[i].corp.tss).toFixed(1)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].corp.assdValue + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].corp.tcg + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + (data.stks[i].corp.apes).toFixed(1) + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].corp.patentCount + "</div>"
                                        + " <div class='xl-str-3 xl-flex-col xl-center' style='text-align:center'>" + (data.stks[i].corp.mktCap).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + "</div>";
                                    $("#_tss_rank").append(htmlStr);
                                } else {
                                    var htmlStr = "<div class='xl-st-row'>"
                                        + " <div class='xl-str-1 xl-flex-col xl-center'>" + data.stks[i].isuKorNm + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='border-right:none'>" + ((data.stks[i].corp.tii).toFixed(2)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='border-left:red solid 1px;border-right:red solid 1px;text-align:center'>" + ((data.stks[i].corp.tss).toFixed(1)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].corp.assdValue + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].corp.tcg + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + (data.stks[i].corp.apes).toFixed(1) + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center' style='text-align:center'>" + data.stks[i].corp.patentCount + "</div>"
                                        + " <div class='xl-str-3 xl-flex-col xl-center' style='text-align:center'>" + (data.stks[i].corp.mktCap).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + "</div>";
                                    $("#_tss_rank").append(htmlStr);
                                }
                            } else {
                                if( (i+1) == data.totalCnt ) {
                                    var htmlStr = "<div class='xl-st-row'>"
                                        + " <div class='xl-str-1 xl-flex-col xl-center xl-str-g'>" + data.stks[i].isuKorNm + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='border-right:none'>" + ((data.stks[i].corp.tii).toFixed(2)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='border-bottom:red solid 1px;border-left:red solid 1px;border-right:red solid 1px;text-align:center'>" + ((data.stks[i].corp.tss).toFixed(1)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].corp.assdValue + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].corp.tcg + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + (data.stks[i].corp.apes).toFixed(1) + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].corp.patentCount + "</div>"
                                        + " <div class='xl-str-3 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + (data.stks[i].corp.mktCap).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + "</div>";
                                    $("#_tss_rank").append(htmlStr);
                                } else {
                                    var htmlStr = "<div class='xl-st-row'>"
                                        + " <div class='xl-str-1 xl-flex-col xl-center xl-str-g'>" + data.stks[i].isuKorNm + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='border-right:none'>" + ((data.stks[i].corp.tii).toFixed(2)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='border-left:red solid 1px;border-right:red solid 1px;text-align:center'>" + ((data.stks[i].corp.tss).toFixed(1)).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].corp.assdValue + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].corp.tcg + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + (data.stks[i].corp.apes).toFixed(1) + "</div>"
                                        + " <div class='xl-str-2 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + data.stks[i].corp.patentCount + "</div>"
                                        + " <div class='xl-str-3 xl-flex-col xl-center xl-str-g' style='text-align:center'>" + (data.stks[i].corp.mktCap).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</div>"
                                        + "</div>";
                                    $("#_tss_rank").append(htmlStr);
                                }
                            }
                        }

                    }
                });
            });

        }

        // 페이지내 스크립트
        $(document).ready( function () {

            sectorId = getParameter("sectorId");
            securityType= getParameter("securityType");
            //sectorId = 5;
            getSectorInfo(sectorId);
            getPatentTrend(sectorId);
            getMainCompany(sectorId);
            getMainCompanies(sectorId);
            drawInvestmentChart(sectorId, securityType);
            drawTSSRankingChart();

        });

    </script>

    <style>

        ._cover {
            display: flex;
            position: relative;
            overflow: hidden;

            flex-direction: column;
            justify-content: flex-start;
            align-items: center;

            width: 100vw;
            height: 134.8vw;
            background-image: url("/extstatic/img/x/cover.png");
            background-size: 100vw 134.8vw;
            background-position-x: center;
            background-position-y: center;
            background-repeat: no-repeat;
        }

        ._title {
            display: flex;
            position: relative;
            overflow: hidden;

            top: 33%;
            font-family: 'Noto Sans KR', 'Montserrat', 'Nanum Gothic', sans-serif;
            font-size: 3vh;
            font-weight: bold;
            color: #222a35;
        }

    </style>

</head>
<body>

<div class="xl-contents">
    <div class="xl-cbody" style="padding-left:0px;padding-right:0px">

        <div style="page-break-before:always">

            <!-- 표지 //-->
            <div style="page-break-before:always" class="xl-flex-col xl-top">

                <div class="_cover">
                    <div style="font-size:6vw" class="_sector_name _title" id="title_name"></div>
                </div>

            </div>

            <!-- ### 타이틀바 ### //-->
            <div class="xl-header xl-flex-row xl-left">
                <div class="_sector_name xl-st-4 xl-flex-col xl-center"></div>
                <div class="xl-st-3">&nbsp;</div>
                <div class="xl-st-2 xl-flex-col xl-center">
                    기술가치투자 섹터 리포트
                </div>
                <div class="xl-st-1">&nbsp;</div>
            </div>

            <!-- 날짜 //-->
            <div class="_rptDt xl-date xl-flex-row xl-right"></div>

            <!-- 1. 개요 //-->
            <div class="xl-title-s1">
                1. 개요
            </div>

            <div class="_rptOutline xl-note-1"></div>

            <div style="height:40px"></div>

            <!-- 2. 업계 주간 이슈 및 기술 트렌드 //-->
            <div class="xl-title-s1">
                2. 업계 주간 이슈 및 기술 트렌드
            </div>
            <div class="_rptIssue xl-note-1"></div>

            <div style="height:40px"></div>

            <!-- 3. 시장성장 동향 //-->
            <div class="xl-title-s1">
                3. 시장성장 동향
            </div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>

            <div style="width:100%" class="xl-flex-col xl-center">
                <div style="width:90%;background-color:#f3f9ff;border:#dddddd solid 1px" class="xl-flex-col">
                    <div style="height:20px"></div>
                    <div style="width:100%;font-size:14px;font-weight:300" class="xl-flex-row">
                        <div style="width:20px"></div><div>TIP</div>
                    </div>
                    <div style="height:10px"></div>
                    <div style="width:100%;font-size:14px;font-weight:300" class="xl-flex-row">
                        <div style="height:20px"></div>
                        <div style="width:20px"></div><div style="width:10px;font-size:12px">•</div>
                        <div style="width:calc( 100% - 50px );font-size:12px;white-space:pre-wrap">출원특허 : 발명자가 발명을 특허권리로 인정받기 위해 특허청에 제출한 문서</div>
                        <div style="height:20px"></div>
                    </div>
                    <div style="width:100%;font-size:14px;font-weight:300" class="xl-flex-row">
                        <div style="height:20px"></div>
                        <div style="width:20px"></div><div style="width:10px;font-size:12px">•</div>
                        <div style="width:calc( 100% - 50px );font-size:12px;white-space:pre-wrap">등록특허 : 출원 후 특허청의 심사를 통과하여 특허권리가 인정된 것</div>
                        <div style="height:20px"></div>
                    </div>
                    <div style="width:100%;font-size:14px;font-weight:300" class="xl-flex-row">
                        <div style="height:20px"></div>
                        <div style="width:20px"></div><div style="width:10px;font-size:12px">•</div>
                        <div style="width:calc( 100% - 50px );font-size:12px;white-space:pre-wrap">보유특허 : 현재 보유하고 있으며 권리가 유효한 등록특허(매입, 매각을 통해 보유 상황이 달라질 수 있음)</div>
                        <div style="height:20px"></div>
                    </div>
                    <div style="height:20px"></div>
                </div>
            </div>

            <div style="height:20px"></div>
            <div class="xl-title-s2">
                (1) 특허 출원 동향
            </div>
            <div class="xl-note-1">일반적으로 R&D 투자가 많을 수록 그 결과물인 특허 출원수가 증가하게 됩니다. 기업의 R&D 규모가 클수록 특허 출원수가 많고, 새로운 제품을 출시하거나 신기술을 개발하는 시점에 특허 출원이 급증하는 경향이 있습니다.</div>
            <div style="height:5px"></div>
            <div class="xl-note-1" style="color:#003eff;font-weight:400;">(모든 특허 출원은 조기공개신청을 하지 않는 한 출원일로부터 18개월 후에 공개되어 최근 출원 데이터에 반영되지 않을 수 있습니다.)</div>

            <div style="height:20px"></div>

            <!-- (1) 특허 출원 동향 그래프 //-->
            <div class="xl-graph-title xl-flex-row xl-center">
                <div class="xl-gt-1">&nbsp;</div>
                <div class="xl-gt-2 xl-flex-col xl-center" id="appYearCount">
                </div>
                <div class="xl-gt-3">&nbsp;</div>
            </div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div id="patent-pt" style="width:100%; height:250px; margin:0 auto;"></div>
            <div class="xl-gt-bottom">&nbsp;</div>

            <div style="height:20px"></div>
            <div class="xl-title-s2">
                (2) 특허 등록 동향
            </div>
            <div class="xl-note-1">등록특허는 까다로운 기술 심사를 통과하여 독점적인 권리가 인증된 특허를 의미합니다. 등록된 특허를 많이 보유할수록 실질적인 기술경쟁력이 있다고 할 수 있습니다.</div>

            <div style="height:20px"></div>

            <!-- (2) 특허 등록 동향 그래프 //-->
            <div class="xl-graph-title xl-flex-row xl-center">
                <div class="xl-gt-1">&nbsp;</div>
                <div class="xl-gt-2 xl-flex-col xl-center" id="regYearCount">
                </div>
                <div class="xl-gt-3">&nbsp;</div>
            </div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div id="patent-pr" style="width:100%; height:250px; margin:0 auto;"></div>
            <div class="xl-gt-bottom">&nbsp;</div>

            <div style="height:40px"></div>

            <!-- 4. 주요기업현황 //-->
            <div class="xl-title-s1">
                4. 주요기업현황
            </div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div class="xl-title-s2">
                (1) 주요기업 특허보유 현황
            </div>
            <div class="xl-note-1">해당 분야에서 활동하는 주요기업 중 특허를 많이 보유 하고 있는 순서입니다.<br>특허수가 많을수록 이 분야의 R&D 활동이 활발하고 기술 경쟁력이 높다고 볼 수 있습니다.</div>
            <div class="xl-paragraph-spacing-20">&nbsp;</div>
            <div class="xl-graph-title xl-flex-row xl-center">
                <div class="xl-gt-1">&nbsp;</div>
                <div class="xl-gt-2 xl-flex-col xl-center">
                    주요기업 특허 보유 건수
                </div>
                <div class="xl-gt-3">&nbsp;</div>
            </div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div id="main_cp" style="width:100%; height:250px; margin:0 auto;"></div>

            <div style="height:20px"></div>

            <div class="xl-title-s2">
                (2) 주요기업 R&D 활동 현황
            </div>
            <div class="xl-note-1">해당분야 기술에 연도별로 얼마나 특허 출원을 했는지를 살펴보면 각 기업들이 그 분야에 얼마나 많은 R&D 활동을 하였으며 최근까지 그 활동이 지속되고 있는지를 알아 볼 수 있습니다.</div>
            <div class="xl-paragraph-spacing-20">&nbsp;</div>
            <div class="xl-graph-title xl-flex-row xl-center">
                <div class="xl-gt-1">&nbsp;</div>
                <div class="xl-gt-2 xl-flex-col xl-center">
                    주요기업 R&D 활동 현황
                </div>
                <div class="xl-gt-3">&nbsp;</div>
            </div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div id="main_cp0" style="width:100%; height:200px; margin:0 auto;display:none"></div>
            <div style="height:10px"></div>
            <div id="main_cp1" style="width:100%; height:200px; margin:0 auto;display:none"></div>
            <div style="height:10px"></div>
            <div id="main_cp2" style="width:100%; height:200px; margin:0 auto;display:none"></div>
            <div style="height:10px"></div>
            <div id="main_cp3" style="width:100%; height:200px; margin:0 auto;display:none"></div>
            <div style="height:10px"></div>
            <div id="main_cp4" style="width:100%; height:200px; margin:0 auto;display:none"></div>

            <div style="height:40px"></div>

            <!-- 5. 투자매력도 상위 종목 Top5 //-->
            <div class="xl-title-s1">
                5. 투자매력도 상위 종목 Top5
            </div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div class="_sector_name xl-title-s2"></div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div class="xl-stock-table" id="_investment_top5">
                <div class="xl-st-title">
                    <div class="xl-stt-1 xl-flex-col xl-center" style="border:none">기업명</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="border-top:red solid 1px;border-left:red solid 1px;border-right:red solid 1px">기술투자지수</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="text-align:center">기술평가점수<br>(TSS)</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="text-align:center">기업가치추정</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="text-align:center">기술경쟁력등급<br>(TCG)</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="text-align:center">특허평가평균점수<br>(APES)</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="text-align:center">특허보유건수</div>
                    <div class="xl-stt-3 xl-flex-col xl-center" style="text-align:center">시가총액<br>(억원)</div>
                </div>
            </div>

            <div style="height:20px"></div>

            <div class="xl-tab-title xl-flex-row xl-left">
                <div class="xl-tt-1 xl-flex-col xl-center" style="width:165px">
                    기술투자지수(시가총액/TSS)
                </div>
                <div class="xl-tt-2">&nbsp;</div>
            </div>
            <div class="xl-note-1" style="background-color:#FBFBFB;border:#D9D9D9 solid 1px">
• &nbsp;기술투자지수란 기업의 시가총액을 TSS(기술평가점수 - 위즈도메인이 개발한 통계기법으로 산출)로 나눈값입니다.

• &nbsp;보유한 기술력대비 주가가 어느정도인지 가늠하는 수치로 동종기술로 분류된 테마내에서 상대비교를 통해 기업의 가치를 평가할 수 있는 보조지표입니다.

• &nbsp;기술투자지수가 낮을수록 "기술력대비 저평가" 되어있어 기술력관점에서 투자매력도가 높습니다.

<b>즉, 기술투자지수가 낮다면 기업이 보유한 기술력보다 주가가 상대적으로 저평가 되어있다는 의미인 것입니다.</b>
            </div>

            <div style="height:20px"></div>

            <div class="xl-graph-title xl-flex-row xl-center">
                <div class="xl-gt-1">&nbsp;</div>
                <div class="xl-gt-2 xl-flex-col xl-center">
                    기술투자지수 = 시총/TSS
                </div>
                <div class="xl-gt-3">&nbsp;</div>
            </div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div style="width:100%;min-height:100px;">
                <img style="width:100%;height:auto" src="/extstatic/img/x/tii.png">
            </div>

            <div style="height:40px"></div>

            <!-- 6. 퀀트기술 분석(TSS 랭킹순) //-->
            <div class="xl-title-s1">
                6. 퀀트기술 분석(TSS 랭킹순)
            </div>
            <div class="xl-note-1">아래 지표는 해당 분야 기업이 보유한 모든 특허의 규모(Quantity)와 기술 수준(Quality)을 동시에 반영한 기술평가점수(TSS : Technology Strength Score) 랭킹을 나타내고 있습니다.
<b>이 지수의 값이 클수록 기업이 보유한 기술 경쟁력이 높다고 판단할 수 있습니다.</b>
            </div>

            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div class="_sector_name xl-title-s2"></div>
            <div class="xl-paragraph-spacing-10">&nbsp;</div>
            <div class="xl-stock-table" id="_tss_rank">
                <div class="xl-st-title">
                    <div class="xl-stt-1 xl-flex-col xl-center">기업명</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="border:none">기술투자지수</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="border-top:red solid 1px;border-left:red solid 1px;border-right:red solid 1px;text-align:center">기술평가점수<br>(TSS)</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="text-align:center">기업가치추정</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="text-align:center">기술경쟁력등급<br>(TCG)</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="text-align:center">특허평가평균점수<br>(APES)</div>
                    <div class="xl-stt-2 xl-flex-col xl-center" style="text-align:center">특허보유건수</div>
                    <div class="xl-stt-3 xl-flex-col xl-center" style="text-align:center">시가총액<br>(억원)</div>
                </div>
            </div>

            <div style="height:100px"></div>

        </div>
    </div>
</div>

</body>
</html>